# ‚úÖ GitHub Secrets - Configuration Compl√®te

## üìä Statut Actuel

**Date**: 5 octobre 2025  
**Repository**: Whalli/whalli  
**Organisation**: Whalli

### Secrets Configur√©s: 18/21 ‚úÖ

| Cat√©gorie | Secrets | Status |
|-----------|---------|--------|
| Database | 1/1 | ‚úÖ |
| Redis | 2/2 | ‚úÖ |
| Auth | 2/2 | ‚úÖ |
| Stripe | 3/3 | ‚úÖ |
| AI Providers | 3/3 | ‚úÖ |
| MinIO | 4/4 | ‚úÖ |
| Monitoring | 1/1 | ‚úÖ |
| Domain | 2/2 | ‚úÖ |
| **Server** | **0/3** | ‚è≥ **√Ä FAIRE** |
| **TOTAL** | **18/21** | **86%** |

---

## ‚úÖ Secrets Cr√©√©s Automatiquement (18)

### 1. Database (1)
- ‚úÖ `DATABASE_URL` - Neon Postgres connection string

### 2. Redis (2)
- ‚úÖ `REDIS_PASSWORD` - Password pour Redis
- ‚úÖ `REDIS_URL` - URL de connexion Redis

### 3. Auth (2)
- ‚úÖ `JWT_SECRET` - Secret pour JWT tokens
- ‚úÖ `BETTER_AUTH_SECRET` - Secret Better Auth

### 4. Stripe (3)
- ‚úÖ `STRIPE_SECRET_KEY` - Cl√© API Stripe
- ‚úÖ `STRIPE_WEBHOOK_SECRET` - Secret webhook Stripe
- ‚úÖ `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` - Cl√© publique Stripe

### 5. AI Providers (3)
- ‚úÖ `OPENAI_API_KEY` - API key OpenAI (GPT-4)
- ‚úÖ `ANTHROPIC_API_KEY` - API key Anthropic (Claude)
- ‚úÖ `XAI_API_KEY` - API key xAI (Grok)

### 6. MinIO (4)
- ‚úÖ `MINIO_ROOT_USER` - Username admin MinIO
- ‚úÖ `MINIO_ROOT_PASSWORD` - Password admin MinIO
- ‚úÖ `MINIO_ACCESS_KEY` - Cl√© d'acc√®s S3 (g√©n√©r√©e)
- ‚úÖ `MINIO_SECRET_KEY` - Cl√© secr√®te S3 (g√©n√©r√©e)

### 7. Monitoring (1)
- ‚úÖ `GRAFANA_ADMIN_PASSWORD` - Password admin Grafana

### 8. Domain (2)
- ‚úÖ `DOMAIN` - Nom de domaine (whalli.com)
- ‚úÖ `ACME_EMAIL` - Email Let's Encrypt (admin@whalli.com)

---

## ‚è≥ Secrets Manquants (3)

### Server Access
Ces secrets n√©cessitent des informations sp√©cifiques √† votre serveur de production :

1. ‚ùå `SSH_PRIVATE_KEY` - Cl√© priv√©e SSH pour d√©ploiement
2. ‚ùå `SERVER_HOST` - IP ou hostname du serveur
3. ‚ùå `SERVER_USER` - Username SSH (ubuntu, root, deploy, etc.)

---

## üöÄ Prochaines √âtapes

### Option 1 : Script Interactif (Recommand√©)

```bash
./scripts/add-server-secrets.sh
```

Ce script va :
1. Demander l'IP de votre serveur (`SERVER_HOST`)
2. Demander le username SSH (`SERVER_USER`)
3. Vous proposer de :
   - **Option A** : G√©n√©rer une nouvelle cl√© SSH (recommand√©)
   - **Option B** : Utiliser une cl√© SSH existante
4. Afficher la cl√© publique √† copier sur le serveur
5. Ajouter automatiquement les 3 secrets √† GitHub

**Dur√©e estim√©e**: 2-3 minutes

---

### Option 2 : Configuration Manuelle

#### 1. SERVER_HOST
```bash
echo "123.45.67.89" | gh secret set SERVER_HOST --repo Whalli/whalli
```

#### 2. SERVER_USER
```bash
echo "ubuntu" | gh secret set SERVER_USER --repo Whalli/whalli
```

#### 3. SSH_PRIVATE_KEY

**a) G√©n√©rer une nouvelle cl√© SSH :**
```bash
ssh-keygen -t ed25519 -C "github-actions-whalli" -f ~/.ssh/github_deploy_whalli -N ""
```

**b) Copier la cl√© publique sur le serveur :**
```bash
ssh-copy-id -i ~/.ssh/github_deploy_whalli.pub ubuntu@123.45.67.89
```

**c) Ajouter la cl√© priv√©e √† GitHub :**
```bash
cat ~/.ssh/github_deploy_whalli | gh secret set SSH_PRIVATE_KEY --repo Whalli/whalli
```

**d) Tester la connexion :**
```bash
ssh -i ~/.ssh/github_deploy_whalli ubuntu@123.45.67.89
```

---

## üîç V√©rification

### V√©rifier tous les secrets
```bash
gh secret list --repo Whalli/whalli
```

**R√©sultat attendu** : 21 secrets list√©s

### Interface Web
https://github.com/Whalli/whalli/settings/secrets/actions

---

## üìù Scripts Disponibles

| Script | Fonction | Dur√©e |
|--------|----------|-------|
| `auto-setup-secrets.sh` | Cr√©e 18 secrets automatiquement | ~5 sec |
| `add-server-secrets.sh` | Ajoute 3 secrets serveur (interactif) | ~2 min |
| `setup-github-secrets.sh` | Configuration compl√®te manuelle | ~10 min |
| `quick-setup-secrets.sh` | Hybride auto/manuel | ~5 min |

**Documentation compl√®te** : [`scripts/README.md`](scripts/README.md)

---

## üéØ Checklist de Configuration

- [x] **Database** - DATABASE_URL
- [x] **Redis** - REDIS_PASSWORD, REDIS_URL
- [x] **Auth** - JWT_SECRET, BETTER_AUTH_SECRET
- [x] **Stripe** - 3 cl√©s
- [x] **AI** - OPENAI, ANTHROPIC, XAI
- [x] **MinIO** - 4 cl√©s
- [x] **Monitoring** - GRAFANA_ADMIN_PASSWORD
- [x] **Domain** - DOMAIN, ACME_EMAIL
- [ ] **Server** - SSH_PRIVATE_KEY, SERVER_HOST, SERVER_USER

**Progression** : 18/21 (86%)

---

## üîê Valeurs Actuelles (depuis .env.production.example)

### Database
```
DATABASE_URL=postgresql://neondb_owner:npg_mtwZEe5RsgL9@ep-purple-butterfly-ado6ohnz-pooler.c-2.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require
```

### Redis
```
REDIS_PASSWORD=4lbxNHlXVfMcSWoG1XQV1/Qpx5/fQWj8cIEMw0RxBx0=
REDIS_URL=redis://4lbxNHlXVfMcSWoG1XQV1/Qpx5/fQWj8cIEMw0RxBx0=@redis:6379
```

### Auth
```
JWT_SECRET=o+biulhuXtohdsq7opCfLbmugT5ZCnRnHSh8qtRALLo=
BETTER_AUTH_SECRET=gnixghpxGKFhfjaxhz7NGi08FrGI9d3qSaObm0jq1xw=
```

### MinIO (G√©n√©r√©es automatiquement)
```
MINIO_ROOT_USER=minio-admin
MINIO_ROOT_PASSWORD=HC8d+QIzZKyey64Ey/C9ZL7qqqWbb+wkvEe5k3SjLUo=
MINIO_ACCESS_KEY=<40-char hex g√©n√©r√©>
MINIO_SECRET_KEY=<32-char base64 g√©n√©r√©>
```

### Domain
```
DOMAIN=whalli.com
ACME_EMAIL=admin@whalli.com
```

---

## ‚ö†Ô∏è Secrets Manquants - Exemples

Voici des exemples de valeurs pour les 3 secrets serveur manquants :

### SERVER_HOST (exemples)
```
# IP publique
123.45.67.89

# Hostname
server.whalli.com

# Instance AWS
ec2-12-34-56-78.compute-1.amazonaws.com
```

### SERVER_USER (exemples)
```
# Ubuntu
ubuntu

# Debian
debian

# CentOS/RHEL
centos

# Custom user
deploy
```

### SSH_PRIVATE_KEY (format)
```
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz
c2gtZWQyNTUxOQAAACBK8...
(plusieurs lignes)
...xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
-----END OPENSSH PRIVATE KEY-----
```

---

## üé¨ Commandes Rapides

### Configuration Compl√®te en 2 Commandes

```bash
# 1. Secrets automatiques (18/21)
./scripts/auto-setup-secrets.sh

# 2. Secrets serveur (3/21)
./scripts/add-server-secrets.sh
```

### V√©rification
```bash
# Liste des secrets
gh secret list --repo Whalli/whalli

# Compte
gh secret list --repo Whalli/whalli | wc -l
# Devrait afficher: 21
```

---

## üöÄ Apr√®s Configuration

Une fois les 21 secrets configur√©s :

### 1. V√©rifier les secrets
```bash
gh secret list --repo Whalli/whalli
```

### 2. Tester le workflow CI/CD
```bash
# Push pour d√©clencher le build
git add .
git commit -m "Configure all GitHub secrets"
git push origin main
```

### 3. Surveiller le workflow
https://github.com/Whalli/whalli/actions/workflows/ci-cd.yml

### 4. D√©ployer en production
https://github.com/Whalli/whalli/actions/workflows/deploy.yml
- Click "Run workflow"
- S√©lectionner "production"
- Click "Run workflow"

---

## üìö Documentation Li√©e

- [`GITHUB_SECRETS_CHECKLIST.md`](GITHUB_SECRETS_CHECKLIST.md) - Checklist compl√®te
- [`GITHUB_ACTIONS_DEPLOYMENT.md`](GITHUB_ACTIONS_DEPLOYMENT.md) - Guide d√©ploiement
- [`ENVIRONMENT_VARIABLES_GUIDE.md`](ENVIRONMENT_VARIABLES_GUIDE.md) - Guide variables
- [`scripts/README.md`](scripts/README.md) - Documentation scripts
- [`.env.production.example`](.env.production.example) - Template configuration

---

## üìû Support

### Questions Fr√©quentes

**Q: Dois-je r√©g√©n√©rer tous les secrets ?**  
R: Non, les secrets existants (18/21) fonctionnent. Il ne manque que les 3 secrets serveur.

**Q: Les cl√©s API (OpenAI, Stripe, etc.) sont-elles valides ?**  
R: Oui, elles proviennent de `.env.production.example` et sont utilis√©es en production.

**Q: Puis-je changer un secret plus tard ?**  
R: Oui, utilisez : `echo "new_value" | gh secret set SECRET_NAME --repo Whalli/whalli`

**Q: Comment supprimer un secret ?**  
R: `gh secret delete SECRET_NAME --repo Whalli/whalli`

**Q: Les secrets sont-ils visibles dans GitHub ?**  
R: Non, ils sont chiffr√©s. Vous pouvez seulement voir leurs noms, pas leurs valeurs.

---

## üéâ R√©sum√©

‚úÖ **18 secrets configur√©s automatiquement** (86%)  
‚è≥ **3 secrets serveur √† configurer** (14%)  
üöÄ **Script pr√™t** : `./scripts/add-server-secrets.sh`  
üìù **Documentation compl√®te** : Tous les guides disponibles  
üîê **S√©curit√©** : Tous les secrets chiffr√©s dans GitHub  

**Prochaine √©tape** : Ex√©cuter `./scripts/add-server-secrets.sh` pour compl√©ter la configuration !

---

**Date de g√©n√©ration** : 5 octobre 2025  
**Statut** : ‚è≥ 18/21 secrets configur√©s  
**Action requise** : Configurer les 3 secrets serveur  
**Maintenu par** : √âquipe Whalli
